<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Election Results</title>
    <link rel="stylesheet" href="castVote.css" />
    <style>
        .results-container {
            /*max-width: 700px;*/
            width: 90%;
            height: 70vh;
            margin: 2rem auto;
            background: rgba(255, 255, 255,0.5);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 2rem 1.5rem;
        }
        .results-title {
            text-align: center;
            text-transform: uppercase;
            font-weight: 700;
            color: #0ba613;
            font-size: 2rem;
            margin-bottom: 2rem;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
        
        }
        .results-table th, .results-table td {
            border: 1px solid #b0bec5;
            padding: 0.7rem 1rem;
            text-align: center;
            border-radius: 8px;
        }
        .results-table th {
            background: #0ba613;
            border-radius: 8px;
            color: #fff;
        }
        .results-table tr:nth-child(even) {
            background: #f4f8fb;
        }
        .bar {
            height: 18px;
            border-radius: 6px;
            background: #0ba613;
            border-radius: 8px;
            display: inline-block;
        }
        @media (max-width: 900px) {
            .results-container {
                padding: 1rem 0.2rem;
                max-width: 99vw;
            }
            .results-title {
                font-size: 1.3rem;
            }
            .results-table th, .results-table td {
                padding: 0.5rem 0.2rem;
                font-size: 1rem;
            }
        }
        @media (max-width: 600px) {
            .results-container {
                padding: 0.5rem 0.1rem;
                max-width: 100vw;
            }
            .results-title {
                font-size: 1.1rem;
            }
            .results-table {
                font-size: 0.95rem;
                display: block;
                overflow-x: auto;
                width: 100%;
                min-width: 350px;
            }
            .results-table th, .results-table td {
                padding: 0.35rem 0.1rem;
                font-size: 0.92rem;
                min-width: 80px;
            }
            .bar {
                height: 14px;
            }
        }
    </style>
</head>
<body>
    <header>
			<!-- header will contain foor logos and navigation bar; two asside in the left one in the right and one main in the middle -->
			<div class="container">
				<div class="logos">
					<img src="Images/PixelAfrica.jpg" alt="Logo 1" class="logo" />
					<img src="Images/NPPLogo.jpg" alt="Logo 2" class="logo" />
					<img src="Images/IPMC.jpg" alt="Logo 1" class="logo" />
					<!-- <img src="Images/EClogo.png" alt="Logo 2" class="logo" /> -->
				</div>
			</div>
		</header>
    <div class="results-container">
        <div class="results-title">Election Results</div>
        <table class="results-table" id="resultsTable">
            <thead>
                <tr>
                    <th>Candidate</th>
                    <th>Party</th>
                    <th>Votes</th>
                    <th>Percentage</th>
                    <th>Bar</th>
                </tr>
            </thead>
            <tbody>
                <!-- Results will be rendered here -->
            </tbody>
        </table>
    </div>
    <script>
    // --- Render Results ---
    document.addEventListener('DOMContentLoaded', function() {
        // Get all candidates from candidateMap
        let candidateMap = {};
        try {
            candidateMap = JSON.parse(localStorage.getItem('candidateMap')) || {};
        } catch (e) { candidateMap = {}; }
        // Get all votes (simulate: count 'votedCandidate' in localStorage for demo)
        // In real app, this would come from a backend
        let votes = JSON.parse(localStorage.getItem('votes')) || [];
        // For demo, if no votes, use selectedCandidate in localStorage
        if (votes.length === 0 && localStorage.getItem('selectedCandidate')) {
            votes = [localStorage.getItem('selectedCandidate')];
        }
        // Tally votes
        let results = {};
        let totalVotes = 0;
        Object.keys(candidateMap).forEach(cid => {
            results[cid] = 0;
        });
        votes.forEach(cid => {
            if (results.hasOwnProperty(cid)) {
                results[cid]++;
                totalVotes++;
            }
        });
        // Render table
        const tbody = document.querySelector('#resultsTable tbody');
        tbody.innerHTML = '';
        Object.keys(candidateMap).forEach(cid => {
            const cand = candidateMap[cid];
            const voteCount = results[cid] || 0;
            const percent = totalVotes > 0 ? ((voteCount / totalVotes) * 100).toFixed(2) : '0.00';
            tbody.innerHTML += `
                <tr>
                    <td><b>${cand.name}</b></td>
                    <td>${cand.party}</td>
                    <td>${voteCount}</td>
                    <td>${percent}%</td>
                    <td><div class="bar" style="width:${percent * 2}px"></div></td>
                </tr>
            `;
        });
    });
    </script>
     <footer>
			<!-- header will contain foor logos and navigation bar; two asside in the left one in the right and one main in the middle -->
			<div class="container">
				<div class="logos">
					<img src="Images/NigeriaFlag.jpg" alt="Logo 1" class="logo" />
					<img src="Images/NPPLogo.jpg" alt="Logo 2" class="logo" />
					<img src="Images/IPMC.jpg" alt="Logo 1" class="logo" />
					<!-- <img src="Images/EClogo.png" alt="Logo 2" class="logo" /> -->
				</div>
			</div>
		</footer>
</body>
</html>
